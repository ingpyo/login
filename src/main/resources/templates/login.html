<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Kakao Login</title>
</head>
<body>
<h2>Kakao Login</h2>
<form id="loginForm" action="/login" method="post">
  <button type="submit">Kakao Login</button>
</form>

<script>
  document.getElementById("loginForm").addEventListener("submit", async function(event) {
    event.preventDefault();

    // 카카오 로그인 요청
    const response = await fetch("/login", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      }
    });

    if (response.status === 200) {
      const data = await response.json();
      const authCode = data.authCode;

      // 로그인 요청을 위한 form 생성 및 전송
      const loginRequestForm = document.createElement("form");
      loginRequestForm.method = "post";
      loginRequestForm.action = "/auth/login"; // 로그인 요청 엔드포인트

      const socialTypeInput = document.createElement("input");
      socialTypeInput.type = "hidden";
      socialTypeInput.name = "socialType";
      socialTypeInput.value = "KAKAO";
      loginRequestForm.appendChild(socialTypeInput);

      const authCodeInput = document.createElement("input");
      authCodeInput.type = "hidden";
      authCodeInput.name = "authCode";
      authCodeInput.value = authCode;
      loginRequestForm.appendChild(authCodeInput);

      document.body.appendChild(loginRequestForm);
      loginRequestForm.submit();
    }
  });
</script>
</body>
</html>
